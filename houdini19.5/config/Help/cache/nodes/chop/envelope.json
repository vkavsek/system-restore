{"type": "root", "attrs": {"type": "node", "context": "chop", "internal": "envelope", "icon": "CHOP/envelope", "version": null, "namespace": null}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["Envelope"], "extent": [69, 82]}, {"type": "summary", "indent": 0, "text": ["Outputs the maximum amplitude in the vicinity of each sample of the input."], "extent": [82, 165]}, {"type": "para", "indent": 0, "text": ["The Envelope CHOP outputs the maximum amplitude in the vicinity of each sample of the input. It takes the absolute value of the input, and uses a sliding window of a number of samples to find the maximum amplitude near each sample."], "extent": [165, 399]}, {"type": "tip_group", "body": [{"type": "tip", "indent": 0, "role": "item", "extent": [399, 404], "body": [{"type": "para", "indent": 4, "text": ["The loudness levels of an audio track can be kept roughly constant by computing an envelope of the audio with a wide window, and then passing the original audio and the envelope to a ", {"scheme": "Node", "value": "/nodes/chop/math", "type": "link", "text": ["Math CHOP"], "fullpath": "/nodes/chop/math"}, " and selecting Combine CHOP > Divide. This will make the amplitude\n    approximately 1."], "extent": [404, 707]}], "container": true}], "container": true, "role": "item_group"}, {"level": 1, "id": "parameters", "container": true, "type": "parameters_section", "indent": 0, "role": "section", "extent": [707, 719], "body": [{"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Envelope"], "extent": [719, 735], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 4, "text": ["Type"], "extent": [735, 746], "body": [{"type": "para", "indent": 8, "text": ["The two methods of calculating the envelope:"], "extent": [746, 800]}, {"type": "dt_group", "body": [{"type": "dt", "indent": 8, "text": ["Exponential Decay"], "extent": [800, 827], "body": [{"type": "para", "indent": 12, "text": ["For each sample, the value is compared to the previous\n            sample. If it is greater than the previous, the value of the\n            envelope is equal to the value of that sample, and that\n            sample is stored as the current peak. If it is less than,\n            the value of the envelope decays exponentially from the last\n            peak to the current value (as more samples pass that are\n            smaller than the peak, the envelope decays toward the\n            waveform). "], "extent": [827, 1338]}, {"type": "para", "indent": 12, "text": ["Pros of this method: envelope always encloses the\n            data. Cons: slope can be discontinuous, making the output\n            look bumpy."], "extent": [1338, 1494]}], "container": true}, {"type": "dt", "indent": 8, "text": ["Local Maximum Window"], "extent": [1494, 1524], "body": [{"type": "para", "indent": 12, "text": ["The channel is separated into windows of N samples\n            determined by the ", {"type": "ui", "text": ["Envelope Width"]}, ". In each window, the\n            maximum amplitude is found. The maximum value of the window\n            is used as the envelope value. "], "extent": [1524, 1774]}, {"type": "para", "indent": 12, "text": ["Pros of this method: Good\n            shape. Cons: signal sometimes jumps outside the envelope.\n            The signal is quantized, so pulses can be off by as much as\n            N/2."], "extent": [1774, 1971]}], "container": true}], "container": true}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Envelope Bounds"], "extent": [1971, 1992], "body": [{"type": "para", "indent": 8, "text": ["Determines which values are used to compute the envelope:\n        magnitude, power, maximum or minimum values."], "extent": [1992, 2111]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Envelope Width"], "extent": [2111, 2131], "body": [{"type": "para", "indent": 8, "text": ["The width of the window to use in the envelope calculation.\n        Adjust this width to capture as many features of the input as\n        needed. Lower values capture more detail, while higher values\n        create a smoother envelope. It is expressed in Units."], "extent": [2158, 2428]}], "container": true, "attrs": {"channels": "/width"}, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Interpolate"], "extent": [2428, 2445], "body": [{"type": "para", "indent": 8, "text": ["In Local Maximum window mode, this provides interpolation\n        options for the windowed values."], "extent": [2445, 2552]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Normalize Power Envelope"], "extent": [2552, 2582], "body": [{"type": "para", "indent": 8, "text": ["Keeps the total power in the signal constant when adjusting the\n        ", {"type": "ui", "text": ["Envelope Width"]}, "."], "extent": [2582, 2682]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Resample Envelope"], "extent": [2682, 2705], "body": [{"type": "para", "indent": 8, "text": ["If on, the envelope is resampled down to the rate listed in the\n        next parameter. This is very useful for audio."], "extent": [2705, 2832]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 4, "text": ["Sample Rate"], "extent": [2832, 2849], "body": [{"type": "para", "indent": 8, "text": ["The sample rate used to resample the envelope after it is\n        calculated."], "extent": [2881, 2976]}], "container": true, "attrs": {"channels": "/samplerate"}, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 2, "id": "common", "container": true, "type": "h", "indent": 0, "text": ["Common"], "extent": [2334, 2356], "body": [{"type": "para", "indent": 0, "text": ["Some of these parameters may not be available on all CHOP nodes."], "extent": [2356, 2423]}, {"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Scope"], "extent": [2423, 2430], "body": [{"type": "para", "indent": 4, "text": ["To determine which channels get affected, some CHOPs have a scope string. Patterns can be used in the scope, for example ", {"type": "code", "text": ["*"]}, " (match all), and ", {"type": "code", "text": ["?"]}, " (match single character). "], "extent": [2430, 2612]}, {"type": "para", "indent": 4, "text": ["The following are examples of possible channel name matching options:"], "extent": [2612, 2691]}, {"type": "dt_group", "body": [{"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["chan2"]}], "extent": [2691, 2704], "body": [{"type": "para", "indent": 8, "text": ["Matches a single channel name."], "extent": [2704, 2748]}], "container": true}, {"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["chan3 tx ty tz"]}], "extent": [2748, 2770], "body": [{"type": "para", "indent": 8, "text": ["Matches four channel names, separated by spaces."], "extent": [2770, 2832]}], "container": true}, {"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["chan*"]}], "extent": [2832, 2845], "body": [{"type": "para", "indent": 8, "text": ["Matches each channel that starts with ", {"type": "code", "text": ["chan"]}, "."], "extent": [2845, 2908]}], "container": true}, {"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["*foot*"]}], "extent": [2908, 2922], "body": [{"type": "para", "indent": 8, "text": ["Matches each channel that has ", {"type": "code", "text": ["foot"]}, " in it."], "extent": [2922, 2979]}], "container": true}, {"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["t?"]}], "extent": [2979, 2989], "body": [{"type": "para", "indent": 8, "text": ["The ", {"type": "code", "text": ["?"]}, " matches a single character. ", {"type": "code", "text": ["t?"]}, " matches two-character channels starting with t.  "], "extent": [2989, 3093]}], "container": true}, {"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["r[xyz]"]}], "extent": [3093, 3107], "body": [{"type": "para", "indent": 8, "text": ["Matches channels ", {"type": "code", "text": ["rx"]}, ", ", {"type": "code", "text": ["ry"]}, " and ", {"type": "code", "text": ["rz"]}, "."], "extent": [3107, 3162]}], "container": true}, {"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["blend[3-7:2]"]}], "extent": [3162, 3182], "body": [{"type": "para", "indent": 8, "text": ["Matches number ranges giving ", {"type": "code", "text": ["blend3"]}, ", ", {"type": "code", "text": ["blend5"]}, ", and ", {"type": "code", "text": ["blend7"]}, "."], "extent": [3182, 3262]}], "container": true}, {"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["blend[2-3,5,13]"]}], "extent": [3262, 3285], "body": [{"type": "para", "indent": 8, "text": ["Matches channels ", {"type": "code", "text": ["blend2"]}, ", ", {"type": "code", "text": ["blend3"]}, ", ", {"type": "code", "text": ["blend5"]}, ", ", {"type": "code", "text": ["blend13"]}, "."], "extent": [3285, 3356]}], "container": true}, {"type": "dt", "indent": 4, "text": [{"type": "code", "text": ["t[xyz]"]}], "extent": [3356, 3370], "body": [{"type": "para", "indent": 8, "text": [{"type": "code", "text": ["[xyz]"]}, "matches three characters, giving channels ", {"type": "code", "text": ["tx"]}, ", ", {"type": "code", "text": ["ty"]}, " and ", {"type": "code", "text": ["tz"]}, "."], "extent": [3370, 3458]}], "container": true}], "container": true}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Sample Rate Match"], "extent": [3458, 3477], "body": [{"type": "para", "indent": 4, "text": ["The Sample Rate Match Options handle cases where multiple input CHOPs\u2019 sample rates are different."], "extent": [3477, 3585]}, {"type": "dt_group", "body": [{"type": "dt", "indent": 4, "text": ["Resample At First Input\u2019s Rate"], "extent": [3585, 3621], "body": [{"type": "para", "indent": 8, "text": ["Use rate of first input to resample others."], "extent": [3621, 3682]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Resample At Maximum Rate"], "extent": [3682, 3712], "body": [{"type": "para", "indent": 8, "text": ["Resample to highest sample rate."], "extent": [3712, 3758]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Resample At Minimum Rate"], "extent": [3758, 3788], "body": [{"type": "para", "indent": 8, "text": ["Resample to the lowest sample rate."], "extent": [3788, 3841]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Error if Rates Differ"], "extent": [3841, 3868], "body": [{"type": "para", "indent": 8, "text": ["Does not accept conflicting sample rates."], "extent": [3868, 3923]}], "container": true}], "container": true}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Units"], "extent": [3923, 3930], "body": [{"type": "para", "indent": 4, "text": ["The units for which time parameters are specified."], "extent": [3930, 3990]}, {"type": "para", "indent": 4, "text": ["For example, you can specify the amount of time a lag should last for in seconds (default), frames (at the Houdini FPS), or samples (in the CHOP\u2019s sample rate)."], "extent": [3990, 4160]}, {"type": "note_group", "body": [{"type": "note", "indent": 4, "role": "item", "extent": [4160, 4170], "body": [{"type": "para", "indent": 8, "text": ["When you change the Units parameter, it does not convert the existing parameters to the new units."], "extent": [4170, 4282]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Time Slice"], "extent": [4282, 4294], "body": [{"type": "para", "indent": 4, "text": ["Time Slicing is a feature which boosts cooking performance and reduces memory usage. Traditionally, CHOPs calculate the channel over its entire frame range. If the channel does need to be evaluated every frame, then cooking the entire range of the channel is unnecessary. It is more efficient to calculate only the fraction of the channel that is needed. This fraction is known as a Time Slice."], "extent": [4294, 4694]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Unload"], "extent": [4694, 4702], "body": [{"type": "para", "indent": 4, "text": ["Causes the memory consumed by a CHOP to be released after it is cooked and the data passed to the next CHOP."], "extent": [4702, 4816]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Export Prefix"], "extent": [4816, 4836], "body": [{"type": "para", "indent": 4, "text": ["The Export prefix is prepended to CHOP channel names to determine where to export to. "], "extent": [4836, 4932]}, {"type": "para", "indent": 4, "text": ["For example, if the CHOP channel was named ", {"type": "code", "text": ["geo1:tx"]}, ", and the prefix was ", {"type": "code", "text": ["/obj"]}, ", the channel would be exported to ", {"type": "code", "text": ["/obj/geo1/tx"]}, "."], "extent": [4932, 5071]}, {"type": "note_group", "body": [{"type": "note", "indent": 4, "role": "item", "extent": [5071, 5081], "body": [{"type": "para", "indent": 8, "text": ["You can leave the ", {"type": "ui", "text": ["Export Prefix"]}, " blank, but then your CHOP track names need to be absolute paths, such as ", {"type": "code", "text": ["obj:geo1:tx"]}, "."], "extent": [5081, 5214]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Graph Color"], "extent": [5214, 5227], "body": [{"type": "para", "indent": 4, "text": ["Every CHOP has this option. Each CHOP gets a default color assigned for display in the Graph port, but you can override the color in the Common page under Graph Color. There are 36 RGB color combinations in the Palette."], "extent": [5227, 5452]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Graph Color Step"], "extent": [5452, 5470], "body": [{"type": "para", "indent": 4, "text": ["When the graph displays the animation curves and a CHOP has two or more channels, this defines the difference in color from one channel to the next, giving a rainbow spectrum of colors."], "extent": [5470, 5661]}], "container": true, "role": "item"}], "container": true}]}], "text": "Parameters"}, {"level": 1, "id": "locals", "container": true, "type": "locals_section", "indent": 0, "role": "section", "extent": [3001, 3009], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 0, "text": ["C"], "extent": [3009, 3013], "body": [{"type": "para", "indent": 8, "text": ["Current channel index.  "], "extent": [3013, 3046]}], "container": true}, {"type": "dt", "indent": 0, "text": ["NC"], "extent": [3046, 3050], "body": [{"type": "para", "indent": 8, "text": ["Total number of channels."], "extent": [3050, 3085]}], "container": true}], "container": true}], "text": "Locals"}, {"level": 1, "id": "related", "container": true, "type": "related_section", "indent": 0, "role": "section", "extent": [3085, 3094], "body": [{"type": "bullet_group", "body": [{"blevel": 6, "type": "bullet", "indent": 4, "text": [{"scheme": "Node", "value": "/nodes/chop/math", "type": "link", "text": "", "fullpath": "/nodes/chop/math"}], "extent": [3094, 3118]}], "container": true}], "text": "Related"}], "title": ["Envelope"], "summary": ["Outputs the maximum amplitude in the vicinity of each sample of the input."], "included": ["/nodes/chop/common"]}