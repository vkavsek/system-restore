{"type": "root", "attrs": {"icon": "SHELF/torch", "tags": "pyro"}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["Simple GPU Torch"], "extent": [0, 21]}, {"type": "summary", "indent": 0, "text": ["Creates a torch fire that can be fully simulated on the GPU."], "extent": [54, 122]}, {"type": "video_group", "body": [{"ext": null, "type": "video", "indent": 0, "role": "item", "extent": [122, 130], "body": [{"type": "summary", "indent": 8, "text": ["Pyro simulation in the viewport. Colorspace: ACES, Voxels Size: 0.005."], "extent": [197, 286]}], "container": true, "attrs": {"src": "/videos/pyro/shelf/shelf_gpu_torch_fire_viewport.mp4"}}], "container": true, "role": "item_group"}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Overview"], "extent": [286, 301], "body": [{"type": "para", "indent": 0, "text": ["This shelf tool creates a very simple torch fire setup that uses the ", {"scheme": "Node", "value": "/nodes/sop/pyrosolver", "type": "link", "text": ["Pyro Solver\u2019s"], "fullpath": "/nodes/sop/pyrosolver"}, " ", {"type": "ui", "text": ["Minimal OpenCL Solve"]}, " to perform the simulation on your GPU. This ensures that the simulation runs as fast as possible and allows for live parameter manipulation during the simulation. To achieve this, some features must be disabled on the solver. "], "extent": [301, 660]}, {"level": 3, "id": "minimal", "container": true, "type": "h", "indent": 0, "text": ["Minimal OpenCL Solve"], "extent": [14762, 14800], "body": [{"type": "video_group", "body": [{"ext": null, "type": "video", "indent": 0, "role": "item", "extent": [14800, 14809], "body": [], "container": true, "attrs": {"src": "/videos/minimal_solve.mp4"}}], "container": true, "role": "item_group"}, {"type": "para", "indent": 0, "text": ["The ", {"scheme": "Node", "value": "/nodes/sop/pyrosolver", "type": "link", "text": ["Pyro Solver SOP"], "fullpath": "/nodes/sop/pyrosolver"}, " has the ability to perform a ", {"type": "ui", "text": ["Minimal OpenCL"]}, " solve, which is useful for very rapid prototyping. This option is located on the ", {"type": "ui", "text": ["General"]}, " tab in the ", {"type": "ui", "text": ["Simulation Type"]}, " dropdown menu. It allows for interactive manipulation of parameters during a running simulation, which can give you quick feedback of their effects on the simulation."], "extent": [14846, 15228]}, {"type": "para", "indent": 0, "text": ["When this option is selected, some features of the solver are turned off to to ensure that all simulation data can stay in video memory, avoiding costly copies that are necessary when only ", {"type": "ui", "text": ["Use OpenCL"]}, " is turned on."], "extent": [15228, 15447]}, {"type": "tip_group", "body": [{"type": "tip", "indent": 0, "role": "item", "extent": [15447, 15452], "body": [{"type": "para", "indent": 4, "text": ["Turn on ", {"type": "ui", "text": ["Live Parameter Display during Playback"]}, " in the ", {"type": "ui", "text": ["Edit"]}, " menu to make sure the solver interface updates as you are tweaking parameters in the midst of a simulation."], "extent": [15452, 15632]}], "container": true}, {"type": "tip", "indent": 0, "role": "item", "extent": [15632, 15637], "body": [{"type": "para", "indent": 4, "text": ["You can animate the ", {"type": "ui", "text": ["Center"]}, " parameter on the\n    ", {"scheme": "Node", "value": "/nodes/sop/pyrosolver", "type": "link", "text": ["Pyro Solver SOP"], "fullpath": "/nodes/sop/pyrosolver"}, " to move the simulation container. For\n    example, you can do this to track the world-space motion of a moving torch as you\n    are simulating its fire."], "extent": [15637, 15885]}], "container": true}], "container": true, "role": "item_group"}, {"type": "para", "indent": 0, "text": ["To produce fast simulations, ", {"type": "ui", "text": ["Minimal OpenCL"]}, " uses the OpenCL device and imposes the following limitations. "], "extent": [15885, 15997]}, {"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": ["Simulation caching is disabled. This means that you cannot scrub the timeline to view saved results."], "extent": [15997, 16100]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"type": "ui", "text": ["Advection-Reflection"]}, " is not supported."], "extent": [16100, 16145]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["Only a dense simulation can be performed."], "extent": [16145, 16189]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["Dynamic resizing of the container is turned off. A static size needs to be set under the ", {"type": "ui", "text": ["Bound"]}, " tab."], "extent": [16189, 16295]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["The solver will not dynamically substep based on the ", {"type": "ui", "text": ["CFL Condition"]}, "."], "extent": [16295, 16369]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["Sourcing and collider support are more restricted. A frame range needs to be specified for both, and the solver will loop these input sources throughout the simulation. Additionally, the collider must be converted into a signed distance field (called ", {"type": "code", "text": ["collision"]}, ") and a velocity field (", {"type": "code", "text": ["v"]}, ")."], "extent": [16369, 16664]}], "container": true}, {"type": "para", "indent": 0, "text": ["There is more you can do to increase performance:"], "extent": [16664, 16715]}, {"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": ["The use of a ", {"scheme": "Node", "value": "/nodes/sop/pyrobakevolume", "type": "link", "text": ["Pyro Bake Volume SOP"], "fullpath": "/nodes/sop/pyrobakevolume"}, " node should be avoided during look development to maintain performance."], "extent": [16715, 16849]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["Make sure that the Pyro Solver SOP node\u2019s field and shape guides are turned off: ", {"type": "ui", "text": ["Fields \u25b8 Field Guides \u25b8 Field Guide \u25b8 No Guide"]}, " and the appropriate parameter in the ", {"type": "ui", "text": ["Shape"]}, " tab."], "extent": [16849, 17035]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["Use looping sources where possible."], "extent": [17035, 17073]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["If you use microsolvers, check if the ", {"type": "ui", "text": ["Use OpenCL"]}, " option is turned on to avoid bottlenecks."], "extent": [17073, 17171]}], "container": true}, {"type": "tip_group", "body": [{"type": "tip", "indent": 0, "role": "item", "extent": [17171, 17176], "body": [{"type": "para", "indent": 4, "text": ["The ", {"scheme": "Shelf", "value": "../shelf/spyro_simplegroundexplosion", "type": "link", "text": ["Simple GPU Ground Explosion"], "fullpath": "/shelf/spyro_simplegroundexplosion"}, " is a very good start to test performance and solver settings."], "extent": [17176, 17320]}], "container": true}], "container": true, "role": "item_group"}, {"type": "note_group", "body": [{"type": "note", "indent": 0, "role": "item", "extent": [17320, 17326], "body": [{"type": "para", "indent": 4, "text": ["Best performance is achieved when the OpenCL device is set to the GPU that is responsible for rendering the viewport."], "extent": [17326, 17450]}], "container": true}], "container": true, "role": "item_group"}]}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Understanding Simple GPU Torch"], "extent": [693, 730], "body": [{"type": "para", "indent": 0, "text": ["The shelf tool creates a node network consisting a couple of nodes."], "extent": [730, 800]}, {"type": "ord_group", "body": [{"blevel": 2, "type": "ord", "indent": 0, "text": [{"type": "code", "text": ["sphere"]}, " generated the shape for the torch to lit on fire. "], "extent": [800, 863]}, {"blevel": 2, "type": "ord", "indent": 0, "text": [{"type": "code", "text": ["pyrosource"]}, " generates the attributes for pyro sources."], "extent": [863, 922]}, {"blevel": 2, "type": "ord", "indent": 0, "text": [{"type": "code", "text": ["attribnoise_density"]}, " further modifies the generated ", {"type": "code", "text": ["density"]}, " attribute before the points are rasterized to volume sources. "], "extent": [922, 1051]}, {"blevel": 2, "type": "ord", "indent": 0, "text": [{"type": "code", "text": ["attribadjustvector_velocity"]}, " generates a ", {"type": "code", "text": ["v"]}, " attribute to generate initial velocity for the torch fire simulation. "], "extent": [1051, 1171]}, {"blevel": 2, "type": "ord", "indent": 0, "text": [{"type": "code", "text": ["volumerasterizeattributes"]}, " takes the source points and converts their attributes into volumes. The rasterized ", {"type": "code", "text": ["density"]}, ", and ", {"type": "code", "text": ["v"]}, " volumes drive the pyro simulation."], "extent": [1171, 1339]}, {"blevel": 2, "type": "ord", "indent": 0, "text": [{"type": "code", "text": ["pyrosolver"]}, " performs the simulation. Parameters on this node have the greatest influence on the dynamic behavior of the simulation. You can interactively adjust the majority of parameters in the ", {"type": "ui", "text": ["Solving"]}, " and ", {"type": "ui", "text": ["Look"]}, " tabs as the simulation is running."], "extent": [1339, 1598], "body": [{"type": "note_group", "body": [{"type": "note", "indent": 4, "role": "item", "extent": [1598, 1608], "body": [{"type": "para", "indent": 8, "text": ["The incoming volume source\u2019s position is fixed over time at the origin. The animation of a torch source is driven by the ", {"type": "code", "text": ["animate_transform"]}, " node, which then drives the ", {"type": "ui", "text": ["Source Location Offset"]}, " parameter on the ", {"type": "code", "text": ["pyrosolver"]}, "."], "extent": [1608, 1844]}], "container": true}], "container": true, "role": "item_group"}, {"type": "tip_group", "body": [{"type": "tip", "indent": 4, "role": "item", "extent": [1844, 1853], "body": [{"type": "para", "indent": 8, "text": ["Turn on ", {"type": "ui", "text": ["Live Parameter Display during Playback"]}, " in the ", {"type": "ui", "text": ["Edit"]}, " menu to make sure the solver interface updates as you tweak parameters during simulation."], "extent": [1853, 2019]}], "container": true}], "container": true, "role": "item_group"}, {"type": "task_group", "body": [{"ext": null, "type": "task", "indent": 4, "text": ["Increase container size"], "role": "item", "extent": [2019, 2054], "body": [{"type": "para", "indent": 8, "text": ["Change ", {"type": "ui", "text": ["Center"]}, " and ", {"type": "ui", "text": ["Max Size"]}, " parameters under the ", {"type": "ui", "text": ["Setup"]}, " tab."], "extent": [2054, 2142]}, {"type": "para", "indent": 8, "text": ["Larger containers simulate slower and take up more video memory."], "extent": [2142, 2224]}], "container": true}, {"ext": null, "type": "task", "indent": 4, "text": ["Change how fast the sources cycle"], "role": "item", "extent": [2224, 2269], "body": [{"type": "para", "indent": 8, "text": ["Modify ", {"type": "ui", "text": ["Cycle Length"]}, " under ", {"type": "ui", "text": ["Sourcing"]}, ". "], "extent": [2269, 2331]}, {"type": "para", "indent": 8, "text": ["This parameter controls how frequently the sources are restarted. Lowering its value will leave less uninterrupted time between bursts for the explosion to develop."], "extent": [2331, 2505]}], "container": true}], "container": true, "role": "item_group"}], "container": true}], "container": true}]}], "title": ["Simple GPU Torch"], "summary": ["Creates a torch fire that can be fully simulated on the GPU."], "included": ["/pyro/lookdev"]}